<!DOCTYPE html>
<html lang="en">

<head>

    <title>Pharmacy Website</title>

    <!-- Metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Pharmacy Website">
    <meta name="author" content="PESU Proj">
    <link rel="icon" href="img/favicon.png">


    <!-- CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/jumbotron.css" rel="stylesheet">
    <link href="css/material.css" rel="stylesheet">

    <!-- Javascript -->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>

    <script>
        var slideIndex = -1;
        var n = 10;
        async function showSS() {
            await new Promise(r => setTimeout(r, 1500));
            plusSlide();
        }

        function plusSlide() {
            slideIndex += 1;
            slideIndex = slideIndex % n;
            obj.getdetails();
            obj.getDesc();
            obj.showButtons();
            setTimeout(plusSlide, 10000);
        }

        function minusSlide() {
            slideIndex -= 1;
            if (slideIndex == -1) slideIndex = 9;
            slideIndex = slideIndex % n;
            obj.getdetails();
            obj.getDesc();
            setTimeout(plusSlide, 5000);
        }
        var obj = {
            xhr1: new XMLHttpRequest(),
            xhr2: new XMLHttpRequest(),
            getdetails: function() {
                var fd = new FormData();
                fd.append("id", slideIndex);
                this.xhr1.onreadystatechange = this.showmedia;
                this.xhr1.timeout = 6000;
                this.xhr1.open("POST", "http://localhost/medicine/getImage.php", true);
                this.xhr1.responseType = "blob";
                this.xhr1.send(fd);
            },
            getDesc: function() {
                this.xhr2.onreadystatechange = this.showdetails;
                this.xhr2.timeout = 6000;
                this.xhr2.open("GET", "http://localhost/medicine/getDetail.php?id=" + slideIndex.toString(), true);
                this.xhr2.send();
            },

            showmedia: function() {

                if (this.readyState == 4 && this.status == 200) {
                    var data = this.response;
                    i = document.createElement("img");
                    i.src = URL.createObjectURL(data);
                    i.width = "500";
                    i.height = "300";
                    var med = document.getElementById("img");
                    while (med.firstChild)
                        med.removeChild(med.firstChild);
                    med.appendChild(i);
                }
            },

            showdetails: function() {
                if (this.readyState == 4 && this.status == 200) {
                    var info = this.response;
                    document.getElementById("txt").innerHTML = "<i>" + info + "</i>";
                }
            },


            showButtons: async function() {
                await new Promise(r => setTimeout(r, 10000));
                document.getElementById("next").style.display = "block";
                document.getElementById("prev").style.display = "block";
            }

        }
    </script>

    <!-- Additional Styles -->
    <style type="text/css">
        #responsecontainer {
            max-width: 800px;
            max-height: 700px;
            height: auto;
            align-content: center;
            align-items: center;
            text-align: center;
            position: relative;
            overflow: auto;
            overflow-x: hidden;
            margin: 0 auto;
        }

        .cen {
            text-align: center;
            font-family: Sans-Serif;
            margin: auto;
            padding: 5px;
        }
    </style>

    <!-- Javascript -->
    <script type="text/javascript">
        $(document).ready(function() {

            $('#Keyword').keypress(function(e) {
                if (e.keyCode == 13)
                    $('#search').click();
            });


            $("#search").click(function() {
                var Sradio = $(".sradio:checked").val();

                $.ajax({
                    type: "POST",
                    url: "table.php",
                    dataType: "html",
                    data: {
                        Keyword: $("#Keyword").val(),
                        Sradio
                    },
                    cache: false,
                    success: function(data) {
                        $("#responsecontainer").html(data);
                    }
                });
            });
        });
    </script>
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a class="navbar-brand" href="#">Navigation</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

        <div class="collapse navbar-collapse" id="navbarsExampleDefault">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="user.html">Log - In</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main WebPage -->
    <div class="jumbotron">
        <h3 class="display-4" align="center">Pharmacy Website</h3>
        <br /><br /><br />
        <p> Enter the Keyword to searched for... </p>
        <p> Select what to search for Medicine, Company, or Generic Drugs </p>
        <br /><br />
        <script>
            showSS();
        </script>
        <button class="cen" id="prev" type="button" onclick="minusSlide()" style="display:none"><h3><<</h3></button>
        <div class="cen" id="img"> </div>
        <div class="cen" id="txt"> </div>
        <button class="cen" id="next" type="button" onclick="plusSlide()" style="display:none "><h3>>></h3></button><br /><br /><br />

        <div class="form-group" style="width: 500px; margin: 0 auto;">
            <input type="text" name="Keyword" required="required" id="Keyword">
            <label class="control-label" for="input">Enter the Keyword</label>

            <i class="bar" style="max-width: 500px;"></i>

            <button id="search" class="button" type="button" style="position: relative;right: -600px; margin: -50px; float: left; ">
                <span>Search &raquo;</span>
            </button>


            <div class="form-radio">
                <div class="radio">
                    <label>
                        <input type="radio" name="sradio" class="sradio" value="medicine" checked="checked">
                        <i class="helper"></i>
                        Medicine
            		</label>
                </div>
                <div class="radio">
                    <label>
                        <input type="radio" name="sradio" class="sradio" value="company">
                        <i class="helper"></i>
                        Company
            		</label>
                </div>
                <div class="radio">
                    <label>
                        <input type="radio" name="sradio" class="sradio" value="generic">
                        <i class="helper"></i>
                        Generic Drug
            		</label>
                </div>
                <div class="radio">
                    <label>
                        <input type="radio" name="sradio" class="sradio" value="pharm">
                        <i class="helper"></i>
                        Pharmacies
            		</label>
                </div>
                <div class="radio">
                    <label>
                        <input type="radio" name="sradio" class="sradio" value="symptom">
                        <i class="helper"></i>
                        Symptom
            		</label>
                </div>
            </div>
        </div>

        <!-- Stores the PHP returned Table -->
        <div id="responsecontainer" style="margin-top: 50px;"></div>
        <br />
        <br />

        <center>Displaying Table and Images Above</center>
        <br />
        <br />
    </div>

</body>

</html>
